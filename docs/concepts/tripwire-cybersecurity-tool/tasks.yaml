GeneratedAt: "2026-02-26T10:36:45Z"
Plan: tripwire-cybersecurity-tool-plan
Sprints:
- Features:
  - FeatureID: tripwire-cybersecurity-tool-feat-agent-transport
    FeatureTitle: gRPC mTLS Transport Client
    Tasks:
    - AcceptanceCriteria:
      - alert.proto defines StreamAlerts (bidirectional) and RegisterAgent (unary)
        with correct message types
      - Generated alert.pb.go and alert_grpc.pb.go compile without errors
      - go generate or Makefile target reproduces the generated files deterministically
      AgentType: backend-engineer
      Dependencies: []
      Description: Author the proto/alert.proto file defining the StreamAlerts bidirectional
        stream and RegisterAgent unary RPC, including all request/response message
        types. Run protoc to generate proto/alert.pb.go and proto/alert_grpc.pb.go.
        Ensure generated code compiles cleanly.
      EstimatedEffort: S
      Files:
      - proto/alert.proto
      - proto/alert.pb.go
      - proto/alert_grpc.pb.go
      ID: task-tripwire-cybersecurity-tool-feat-agent-transport-1
      Title: Define proto schema for StreamAlerts and RegisterAgent RPCs
    - AcceptanceCriteria:
      - Client dials with tls.Config using client cert/key and CA pool; connection
        fails if certs are missing or invalid
      - RegisterAgent RPC is called immediately after a successful dial
      - Reconnection uses exponential backoff with configurable max interval; reconnect_total
        counter increments on each attempt
      - Prometheus metrics are registered and report correct values observable via
        /metrics
      AgentType: backend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-agent-transport-1
      Description: Implement the GRPCClient struct in internal/transport/grpc_client.go
        that dials the server using mTLS client certificates loaded from disk, calls
        RegisterAgent on connect, and manages exponential-backoff reconnection loops
        with jitter. Expose Prometheus counters and gauges for reconnect_total, alerts_sent_total,
        and queue_depth.
      EstimatedEffort: M
      Files:
      - internal/transport/grpc_client.go
      ID: task-tripwire-cybersecurity-tool-feat-agent-transport-2
      Title: Implement mTLS gRPC client with exponential-backoff reconnection
    - AcceptanceCriteria:
      - Alerts queued in SQLite while offline are sent in order after reconnect and
        deleted on ACK
      - alerts_sent_total increments for every successfully acknowledged alert; queue_depth
        reflects current undelivered row count
      - A server-side stream error causes the client to re-enter the backoff loop
        without dropping queue entries
      - Unit test with a mock gRPC server verifies queue drain ordering and metric
        values
      AgentType: backend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-agent-transport-2
      Description: Wire the StreamAlerts bidirectional stream into the GRPCClient
        so it reads pending alerts from the SQLite queue, sends them upstream, and
        removes them on server ACK. On each reconnect, flush any queued rows before
        resuming live event forwarding. Update queue_depth gauge and alerts_sent_total
        counter as records are drained and sent.
      EstimatedEffort: L
      Files:
      - internal/transport/grpc_client.go
      ID: task-tripwire-cybersecurity-tool-feat-agent-transport-3
      Title: Implement bidirectional StreamAlerts with SQLite queue drain on reconnect
  - FeatureID: tripwire-cybersecurity-tool-feat-websocket
    FeatureTitle: WebSocket Real-Time Broadcaster
    Tasks:
    - AcceptanceCriteria:
      - Broadcaster.Publish fans out messages to all registered channels without blocking
        on slow consumers
      - Register returns a read-only channel; Unregister closes and removes it from
        the map
      - Unit tests cover concurrent register/unregister/publish without data races
        (go test -race)
      AgentType: backend-engineer
      Dependencies: []
      Description: Implement the Broadcaster struct in broadcaster.go with a sync.Map
        of subscriber channels for lock-free fan-out. Expose Register/Unregister for
        client lifecycle and a Publish method that sends alert JSON to all active
        channels. Include graceful shutdown via context cancellation.
      EstimatedEffort: S
      Files:
      - internal/server/websocket/broadcaster.go
      ID: task-tripwire-cybersecurity-tool-feat-websocket-1
      Title: Implement in-process channel broadcaster
    - AcceptanceCriteria:
      - GET /ws/alerts returns 101 Switching Protocols and receives alert JSON pushed
        from Broadcaster.Publish
      - Disconnected clients are automatically unregistered without leaking goroutines
      - Integration test connects two concurrent clients and asserts both receive
        the same published alert
      AgentType: backend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-websocket-1
      Description: Implement the HTTP handler in handler.go that upgrades connections
        to ws://dashboard/ws/alerts using gorilla/websocket, registers each client
        with the Broadcaster, and pumps messages from the client's channel to the
        WebSocket write loop. Handle ping/pong keepalives and clean up on disconnect.
      EstimatedEffort: M
      Files:
      - internal/server/websocket/handler.go
      ID: task-tripwire-cybersecurity-tool-feat-websocket-2
      Title: Implement WebSocket upgrade handler
  - FeatureID: tripwire-cybersecurity-tool-feat-deployment
    FeatureTitle: Deployment & CI/CD
    Tasks:
    - AcceptanceCriteria:
      - docker compose up starts server and PostgreSQL; server passes health check
        within 30s
      - Database migrations run automatically on container start
      - Server container connects to PostgreSQL using environment-provided credentials
      - docker compose down preserves data in named volume across restarts
      AgentType: devops-engineer
      Dependencies: []
      Description: Create the Dockerfile.server for the dashboard backend and a Docker
        Compose file that wires together the server container and PostgreSQL. Include
        health checks, volume mounts for persistent data, and environment variable
        configuration for database credentials and gRPC/REST ports.
      EstimatedEffort: M
      Files:
      - deployments/Dockerfile.server
      - deployments/docker-compose.yml
      ID: task-tripwire-cybersecurity-tool-feat-deployment-1
      Title: Docker Compose and server container setup
    - AcceptanceCriteria:
      - systemctl enable --now tripwire starts agent and survives reboot on Linux
      - launchctl load com.tripwire.agent.plist starts agent at login on macOS
      - Agent process is restarted automatically within 5s after a crash on both platforms
      - Unit files pass systemd-analyze verify and launchd plist validation (plutil
        -lint)
      AgentType: devops-engineer
      Dependencies: []
      Description: Write the systemd service unit for Linux and the launchd plist
        for macOS to manage the tripwire agent process. Both should configure automatic
        restart on failure, set appropriate working directories and log paths, and
        reference the installed agent binary location.
      EstimatedEffort: S
      Files:
      - deployments/systemd/tripwire.service
      - deployments/launchd/com.tripwire.agent.plist
      ID: task-tripwire-cybersecurity-tool-feat-deployment-2
      Title: Agent lifecycle unit files (systemd and launchd)
    - AcceptanceCriteria:
      - Workflow runs on push to main and on semver tags; all four GOOS/GOARCH combinations
        produce binaries
      - Binaries are statically linked (ldd reports 'not a dynamic executable' on
        Linux targets)
      - Tagged releases automatically create a GitHub Release with all four binaries
        attached
      - Build matrix completes without platform-specific failures in CI
      AgentType: devops-engineer
      Dependencies: []
      Description: Implement a GitHub Actions workflow that builds statically-compiled
        agent binaries for linux/amd64, linux/arm64, darwin/amd64, and darwin/arm64
        using a matrix strategy with CGO_ENABLED=0. Binaries should be attached as
        release artifacts on tagged pushes and archived on every main-branch commit.
      EstimatedEffort: M
      Files:
      - .github/workflows/build.yml
      ID: task-tripwire-cybersecurity-tool-feat-deployment-3
      Title: GitHub Actions build matrix for cross-platform agent binaries
  Sprint: 4
- Features:
  - FeatureID: tripwire-cybersecurity-tool-feat-dashboard-ui
    FeatureTitle: Real-Time Security Dashboard
    Tasks:
    - AcceptanceCriteria:
      - Vite dev server starts with hot-reload; TypeScript compiles with strict mode
      - OIDC login redirects correctly and stores bearer token in memory/localStorage;
        unauthenticated requests redirect to login
      - API client attaches Authorization header and exposes typed fetch helpers for
        REST endpoints
      AgentType: frontend-engineer
      Dependencies: []
      Description: Initialize the Vite + React 18 + TypeScript project, configure
        TanStack Query, and implement the API client with bearer token storage and
        the OIDC login/callback flow. This provides the foundation all other tasks
        build on.
      EstimatedEffort: M
      Files:
      - dashboard-ui/vite.config.ts
      - dashboard-ui/src/App.tsx
      - dashboard-ui/src/api/client.ts
      ID: task-tripwire-cybersecurity-tool-feat-dashboard-ui-1
      Title: Project scaffold, API client, and OIDC auth
    - AcceptanceCriteria:
      - useWebSocket reconnects automatically on disconnect and correctly applies
        bearer token in the upgrade request
      - New alerts appear in the feed within 200 ms of receipt without a full list
        re-render
      - AlertFeed virtualizes rows so DOM node count stays constant regardless of
        alert volume
      AgentType: frontend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-dashboard-ui-1
      Description: Implement useWebSocket to manage the WS connection lifecycle (reconnect,
        auth handshake) and patch incoming alert events into the TanStack Query cache.
        Build the AlertFeed component using react-window virtualized list to render
        the live stream without DOM thrashing.
      EstimatedEffort: L
      Files:
      - dashboard-ui/src/hooks/useWebSocket.ts
      - dashboard-ui/src/hooks/useAlerts.ts
      - dashboard-ui/src/components/AlertFeed.tsx
      ID: task-tripwire-cybersecurity-tool-feat-dashboard-ui-2
      Title: WebSocket hook and live alert feed component
    - AcceptanceCriteria:
      - Host list loads from REST API and updates on reconnect; each row shows online/offline
        status
      - Selecting or deselecting hosts updates a shared filter context and triggers
        alert feed refetch
      - Multi-host selection persists in URL query params so the view is bookmarkable
      AgentType: frontend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-dashboard-ui-1
      Description: Implement the HostList component that fetches host inventory via
        TanStack Query and lets users toggle one or more hosts as active. Selected
        host IDs flow into a shared filter context consumed by the alert feed and
        trend chart.
      EstimatedEffort: M
      Files:
      - dashboard-ui/src/components/HostList.tsx
      ID: task-tripwire-cybersecurity-tool-feat-dashboard-ui-3
      Title: Multi-host selector and host status overview
    - AcceptanceCriteria:
      - All four filter dimensions (host, type, severity, time range) are functional
        and reflected in API request params
      - Filter changes debounce 300 ms before issuing a new network request
      - Active filters are serialized into URL search params; reloading the page restores
        filter state
      AgentType: frontend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-dashboard-ui-3
      Description: Build the AlertFilters component with controls for host, tripwire
        type, severity, and time-range. Wire filters to TanStack Query so every change
        triggers a debounced refetch against the REST alerts endpoint with the correct
        query params.
      EstimatedEffort: M
      Files:
      - dashboard-ui/src/components/AlertFilters.tsx
      - dashboard-ui/src/hooks/useAlerts.ts
      ID: task-tripwire-cybersecurity-tool-feat-dashboard-ui-4
      Title: Alert filtering controls and TanStack Query integration
    - AcceptanceCriteria:
      - Chart renders a line/area series per severity level with labeled axes and
        a legend
      - Chart updates within one render cycle when a new alert arrives via WebSocket
      - Chart respects the active time-range filter and re-bins data client-side without
        an extra API call
      AgentType: frontend-engineer
      Dependencies:
      - task-tripwire-cybersecurity-tool-feat-dashboard-ui-4
      - task-tripwire-cybersecurity-tool-feat-dashboard-ui-2
      Description: Implement TrendChart using recharts to display alert volume over
        the selected time range, grouped by severity. The chart data is derived from
        the same TanStack Query result set as the alert feed and re-renders reactively
        when filters or new WS events change the cache.
      EstimatedEffort: M
      Files:
      - dashboard-ui/src/components/TrendChart.tsx
      ID: task-tripwire-cybersecurity-tool-feat-dashboard-ui-5
      Title: Alert volume trend chart
  Sprint: 5
