# TripWire Agent configuration example.
# Copy to /etc/tripwire/config.yaml and adjust for your environment.

# Required: gRPC endpoint of the TripWire dashboard server (host:port).
dashboard_addr: "dashboard.example.com:4443"

# TLS: paths to the agent mTLS credentials. All three fields are required.
# Certificates are generated by the scripts in deployments/certs/.
# Files must be readable by the tripwire system user (mode 0600).
tls:
  cert_path: "/etc/tripwire/agent.crt"
  key_path:  "/etc/tripwire/agent.key"
  ca_path:   "/etc/tripwire/ca.crt"

# Optional: minimum log severity. One of: debug, info, warn, error.
# Defaults to "info".
log_level: "info"

# Optional: listen address for the /healthz HTTP liveness endpoint.
# Only bind to loopback â€” the agent does not open external inbound ports.
# Defaults to "127.0.0.1:9000".
health_addr: "127.0.0.1:9000"

# Optional: human-readable agent version sent to the dashboard on registration.
agent_version: "v0.1.0"

# rules defines the file paths, network ports, and process names to monitor.
# Each entry requires: name, type (FILE | NETWORK | PROCESS),
# target (path, port, or process name), and severity (INFO | WARN | CRITICAL).
rules:
  - name: etc-passwd-watch
    type: FILE
    target: "/etc/passwd"
    severity: CRITICAL

  - name: etc-shadow-watch
    type: FILE
    target: "/etc/shadow"
    severity: CRITICAL

  - name: ssh-port-watch
    type: NETWORK
    target: "22"
    severity: WARN

  - name: bash-process-watch
    type: PROCESS
    target: "bash"
    severity: INFO
