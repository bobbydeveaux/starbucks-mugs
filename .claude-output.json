{
  "prTitle": "feat: fan persisted alerts to WebSocket broadcaster (grpc-server-3)",
  "prBody": "## Summary\n\n- Implements `task-tripwire-cybersecurity-tool-feat-grpc-server-3`: after a valid `AgentEvent` is persisted to PostgreSQL, publish it to the WebSocket broadcaster so connected browser clients receive real-time updates\n- Uses a non-blocking `select/default` send in `InProcessBroadcaster.Publish` so a slow or disconnected WebSocket consumer never stalls the gRPC `StreamAlerts` goroutine\n- All three acceptance criteria are satisfied and covered by automated tests\n\n## Files Changed\n\n| File | Purpose |\n|---|---|\n| `proto/alert.proto` | Proto3 service definition (StreamAlerts, RegisterAgent RPCs) |\n| `proto/alert/alert.pb.go` | Hand-written proto message stubs (to be regenerated with protoc) |\n| `proto/alert/alert_grpc.pb.go` | Hand-written gRPC service stubs |\n| `internal/server/websocket/broadcaster.go` | In-process WebSocket broadcaster with non-blocking fan-out |\n| `internal/server/grpc/alert_service.go` | AlertService: validate → persist → broadcast each AgentEvent |\n| `internal/server/grpc/alert_service_test.go` | Unit + integration tests covering all 3 acceptance criteria |\n| `docs/concepts/tripwire-cybersecurity-tool/grpc-alert-service.md` | Reference doc for gRPC service and broadcaster |\n\n## Acceptance Criteria\n\n| # | Criterion | Implementation |\n|---|---|---|\n| §1 | Each persisted alert published without blocking StreamAlerts | `broadcaster.Publish(alert)` called after `store.BatchInsertAlerts` succeeds; `Publish` uses non-blocking `select/default` |\n| §2 | Slow/disconnected WS consumer causes no back-pressure | Per-subscriber buffered channel; `Publish` drops and logs on full buffer; tested by `TestStreamAlerts_SlowSubscriberDoesNotBlock` |\n| §3 | Integration test: ingested event appears on WS subscription | `TestIntegration_IngestedEventAppearsOnWebSocketSubscription` wires real broadcaster to service and asserts event delivery |\n\nCloses #221",
  "testsPass": true,
  "filesChanged": [
    "proto/alert.proto",
    "proto/alert/alert.pb.go",
    "proto/alert/alert_grpc.pb.go",
    "internal/server/websocket/broadcaster.go",
    "internal/server/grpc/alert_service.go",
    "internal/server/grpc/alert_service_test.go",
    "go.mod"
  ],
  "docsUpdated": [
    "docs/concepts/tripwire-cybersecurity-tool/grpc-alert-service.md"
  ],
  "docsReviewed": [
    "docs/concepts/tripwire-cybersecurity-tool/HLD.md",
    "docs/concepts/tripwire-cybersecurity-tool/storage.md",
    "docs/concepts/tripwire-cybersecurity-tool/tasks.yaml"
  ],
  "completedTasks": [1, 2, 3, 4, 5, 6]
}
