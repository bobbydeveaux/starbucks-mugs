{
  "prTitle": "feat: implement eBPF kernel program and process watcher for execve tracing",
  "prBody": "## Summary\n\nImplements `task-tripwire-cybersecurity-tool-feat-process-watcher-1`: eBPF kernel program and Go runtime for tracing `execve`/`execveat` syscalls.\n\n### What was built\n\n**`internal/watcher/ebpf/process.bpf.c`** — eBPF kernel program\n- Attaches to `tracepoint/syscalls/sys_enter_execve` and `tracepoint/syscalls/sys_enter_execveat`\n- Writes a structured `exec_event` (pid, ppid, uid, gid, comm, filename, argv) to a 16 MiB BPF ring buffer on every execve call\n- `fill_argv` helper reads up to 16 argv entries space-joined into a single NUL-terminated string\n- CO-RE-compatible via `vmlinux.h` (auto-generated from running kernel BTF)\n- Licensed GPL-2.0-or-later to enable GPL-only BPF helpers\n\n**`internal/watcher/ebpf/process.h`** — shared C/Go header\n- Defines the `exec_event` struct shared between the BPF program and the Go userspace loader\n\n**`internal/watcher/ebpf/Makefile`** — eBPF build instructions\n- Clang/LLVM toolchain invocation for compiling `process.bpf.o`\n\n**`internal/watcher/process_watcher.go`** — platform-agnostic core\n- `ProcessWatcher` struct + `NewProcessWatcher` constructor (filters to `PROCESS`-type rules)\n- `matchingRule` glob matching against both basename and full path\n- `emitExecEvent` constructs and delivers `AlertEvents`\n- Thread-safe with `sync.Mutex` + `sync.Once`\n\n**`internal/watcher/process_watcher_linux.go`** — Linux runtime\n- Uses `NETLINK_CONNECTOR` / `PROC_EVENT_EXEC` (zero-polling, kernel-driven)\n- `Start` opens and binds a `NETLINK_CONNECTOR` socket, subscribes to process events\n- `readLoop` background goroutine with 1-second `SO_RCVTIMEO` for ctx.Done() checks\n- `parseNetlinkMessages` / `handleNetlinkMessage` decode the kernel ABI structs\n- `readProcInfo` enriches events with `/proc/<pid>/comm`, `exe`, `cmdline`\n- `sendProcCNMsg` builds and sends control messages to start/stop event delivery\n- Requires `CAP_NET_ADMIN` or root; returns descriptive error otherwise\n\n**`internal/watcher/process_watcher_other.go`** — non-Linux stub\n- Returns an error on `Start` listing the current platform\n\n### Review feedback addressed\n\n- Removed accidentally committed `go1.22.0.linux-amd64.tar.gz` (69 MB binary) from git tracking\n- Added `*.tar.gz`, `*.tar.bz2`, `*.tar.xz`, and `*.zip` patterns to `.gitignore` to prevent future accidental inclusion of binary archives\n\n### Tests\n\n- `process_watcher_linux_test.go` — 10 tests covering:\n  - Interface compliance (compile-time assertion)\n  - Constructor filtering\n  - Unprivileged error path\n  - Start/Stop lifecycle (idempotency)\n  - Context cancellation\n  - Events channel closed after Stop\n  - End-to-end: exec a real process, verify AlertEvent fields\n  - Pattern filter: only matching processes emit events\n  - Struct size constant regression guard\n\n### Acceptance criteria met\n\n- ✅ eBPF C program attaches to execve/execveat tracepoints\n- ✅ Structured exec_event written to BPF ring buffer (pid, ppid, uid, gid, comm, filename, argv)\n- ✅ Go ProcessWatcher implements agent.Watcher interface\n- ✅ Rule-based filtering with glob patterns on process name\n- ✅ Linux runtime uses NETLINK_CONNECTOR (zero-polling)\n- ✅ Non-Linux stub returns descriptive error\n- ✅ Start/Stop are idempotent and thread-safe\n- ✅ Binary archives excluded from git tracking\n\nCloses #216",
  "testsPass": true,
  "filesChanged": [
    ".gitignore",
    "internal/watcher/ebpf/Makefile",
    "internal/watcher/ebpf/process.bpf.c",
    "internal/watcher/ebpf/process.h",
    "internal/watcher/process_watcher.go",
    "internal/watcher/process_watcher_linux.go",
    "internal/watcher/process_watcher_linux_test.go",
    "internal/watcher/process_watcher_other.go"
  ],
  "docsUpdated": [
    "docs/concepts/tripwire-cybersecurity-tool/process-watcher.md"
  ],
  "docsReviewed": [
    "docs/concepts/tripwire-cybersecurity-tool/README.md",
    "docs/concepts/tripwire-cybersecurity-tool/LLD.md",
    "docs/concepts/tripwire-cybersecurity-tool/tasks.yaml"
  ],
  "completedTasks": [1, 2, 3, 4]
}
