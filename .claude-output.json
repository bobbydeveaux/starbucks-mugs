{
  "prTitle": "feat: expose Prometheus metrics for transport layer",
  "prBody": "## Summary\n\n- Add `Metrics` struct (`agent/internal/transport/metrics.go`) with nine atomic counters/gauges covering all critical transport-layer events\n- Instrument `Client` via a backward-compatible `WithMetrics(m *Metrics)` functional option; nil metrics are a no-op with a single pointer-check on the hot path\n- Expose metrics in standard Prometheus text exposition format (v0.0.4) via `Metrics.Handler()` â€” pure stdlib, no new dependencies\n- Add integration tests in `metrics_test.go` verifying counter increments on happy path, error/reconnect paths, and nil-safe operation\n- Document the full metric catalogue, wiring example, scrape config, and alerting rules in `docs/concepts/tripwire-cybersecurity-tool/transport-metrics.md`\n\n### Metrics exposed\n\n| Metric | Type |\n|---|---|\n| `transport_connection_attempts_total` | counter |\n| `transport_connection_errors_total` | counter |\n| `transport_reconnect_attempts_total` | counter |\n| `transport_agent_registrations_total` | counter |\n| `transport_registration_errors_total` | counter |\n| `transport_alerts_sent_total` | counter |\n| `transport_stream_send_errors_total` | counter |\n| `transport_stream_recv_errors_total` | counter |\n| `transport_connected` | gauge |\n\n### Usage\n\n```go\nm := transport.NewMetrics()\nclient := transport.New(cfg, logger, transport.WithMetrics(m))\nhttp.Handle(\"/metrics\", m.Handler())\n```\n\nCloses #226",
  "testsPass": true,
  "filesChanged": [
    "agent/internal/transport/metrics.go",
    "agent/internal/transport/client.go",
    "agent/internal/transport/metrics_test.go",
    "agent/README.md",
    "docs/concepts/tripwire-cybersecurity-tool/transport-metrics.md"
  ],
  "docsUpdated": [
    "docs/concepts/tripwire-cybersecurity-tool/transport-metrics.md",
    "agent/README.md"
  ],
  "docsReviewed": [
    "docs/concepts/tripwire-cybersecurity-tool/grpc-alert-service.md",
    "agent/config.example.yaml"
  ],
  "completedTasks": [1, 2, 3, 4, 5]
}
