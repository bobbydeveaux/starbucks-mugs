{
  "prTitle": "feat: implement async SIEM forwarding service",
  "prBody": "## Summary\n\nImplements `SIEMService` in `fileguard/services/siem.py` with fully asynchronous, fire-and-forget delivery of `ScanEvent` records to Splunk HEC and RiverSafe WatchTower REST API.\n\n### What was implemented\n\n- **`fileguard/services/siem.py`** — `SIEMService` class with:\n  - `forward_event(event, config)` — non-blocking fire-and-forget via `asyncio.create_task()`\n  - `_deliver_with_retry()` — exponential back-off retry (configurable retries and base delay)\n  - Immediate abort on non-retryable HTTP 4xx errors\n  - Prometheus counter `siem_delivery_errors_total` labelled by `destination` and `error_type`\n  - Splunk HEC envelope format (`{\"event\": {...}, \"sourcetype\": \"fileguard:scan\"}`)\n  - WatchTower flat JSON payload\n  - Correct auth headers (`Authorization: Splunk <token>` / `Authorization: Bearer <token>`)\n  - Optional shared `httpx.AsyncClient` injection for connection pooling\n- **`fileguard/tests/test_siem.py`** — 20+ unit tests covering:\n  - Successful delivery for both Splunk and WatchTower\n  - Network failure triggers retry and increments error counter\n  - HTTP 5xx triggers retry; counter incremented per attempt\n  - HTTP 4xx non-retryable: immediate abort with single counter increment\n  - Error counter label correctness for both destinations\n  - `forward_event` fire-and-forget behaviour\n  - Transient client creation when no shared client is injected\n  - Payload and header helper function unit tests\n- **`pyproject.toml`** — added `fileguard/tests` to pytest `testpaths`\n- **`docs/concepts/fileguard/siem.md`** — full API reference documentation\n\n### Acceptance criteria met\n\n- [x] `ScanEvent` records forwarded asynchronously to Splunk HEC without blocking scan response\n- [x] `ScanEvent` records forwarded asynchronously to WatchTower without blocking scan response\n- [x] `siem_delivery_errors_total` incremented on any failed delivery attempt\n- [x] Unit tests cover successful delivery, network failure retry, and error counter increment for both destinations\n\nCloses #287",
  "testsPass": true,
  "filesChanged": [
    "fileguard/services/siem.py",
    "fileguard/tests/__init__.py",
    "fileguard/tests/test_siem.py",
    "pyproject.toml"
  ],
  "docsUpdated": [
    "docs/concepts/fileguard/siem.md"
  ],
  "docsReviewed": [
    "docs/concepts/fileguard/audit.md",
    "docs/concepts/fileguard/HLD.md",
    "docs/concepts/fileguard/LLD.md",
    "docs/concepts/fileguard/PRD.md",
    "docs/concepts/fileguard/ROAM.md"
  ],
  "completedTasks": [1]
}
